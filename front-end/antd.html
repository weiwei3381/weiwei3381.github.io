<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React ä¸ Antd å¼€å‘å‰ç«¯é¡µé¢ | å°ç†Šçš„æŠ€æœ¯æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/fav.ico">
    <link rel="stylesheet" href="/css/katex.min.css">
    <link rel="stylesheet" href="/css/github-markdown.min.css">
    <meta name="description" content="è¡£å¸¦æ¸å®½ç»ˆä¸æ‚”ï¼Œä¸ºä¼Šæ¶ˆå¾—äººæ†”æ‚´">
    
    <link rel="preload" href="/assets/css/0.styles.f841f567.css" as="style"><link rel="preload" href="/assets/js/app.172e5c27.js" as="script"><link rel="preload" href="/assets/js/2.983eb755.js" as="script"><link rel="preload" href="/assets/js/18.3af7782b.js" as="script"><link rel="prefetch" href="/assets/js/10.609f238e.js"><link rel="prefetch" href="/assets/js/11.c724f89a.js"><link rel="prefetch" href="/assets/js/12.d06db9a0.js"><link rel="prefetch" href="/assets/js/13.54ef98aa.js"><link rel="prefetch" href="/assets/js/14.395e2b25.js"><link rel="prefetch" href="/assets/js/15.267ab24d.js"><link rel="prefetch" href="/assets/js/16.3a1d6a3d.js"><link rel="prefetch" href="/assets/js/17.511ee7ec.js"><link rel="prefetch" href="/assets/js/19.7ddd4ea1.js"><link rel="prefetch" href="/assets/js/20.8a7143cc.js"><link rel="prefetch" href="/assets/js/21.6b97d8cd.js"><link rel="prefetch" href="/assets/js/22.c585fce6.js"><link rel="prefetch" href="/assets/js/23.b0fcb690.js"><link rel="prefetch" href="/assets/js/24.ca223bca.js"><link rel="prefetch" href="/assets/js/25.014e71b5.js"><link rel="prefetch" href="/assets/js/26.528837b7.js"><link rel="prefetch" href="/assets/js/27.03e05e51.js"><link rel="prefetch" href="/assets/js/28.80229a71.js"><link rel="prefetch" href="/assets/js/29.51838c3e.js"><link rel="prefetch" href="/assets/js/3.4e77dfef.js"><link rel="prefetch" href="/assets/js/30.c5136fb3.js"><link rel="prefetch" href="/assets/js/31.355c2d8b.js"><link rel="prefetch" href="/assets/js/32.10c26156.js"><link rel="prefetch" href="/assets/js/33.7e7fac82.js"><link rel="prefetch" href="/assets/js/34.89a85b94.js"><link rel="prefetch" href="/assets/js/35.fb738fef.js"><link rel="prefetch" href="/assets/js/36.a8fe1d78.js"><link rel="prefetch" href="/assets/js/37.d136dff5.js"><link rel="prefetch" href="/assets/js/38.73e50b4c.js"><link rel="prefetch" href="/assets/js/39.1cbe227d.js"><link rel="prefetch" href="/assets/js/4.772ac0bd.js"><link rel="prefetch" href="/assets/js/40.a83eec21.js"><link rel="prefetch" href="/assets/js/41.573ff2da.js"><link rel="prefetch" href="/assets/js/42.61544b41.js"><link rel="prefetch" href="/assets/js/43.ec09f4c1.js"><link rel="prefetch" href="/assets/js/44.cd1cea5b.js"><link rel="prefetch" href="/assets/js/45.83f86d1b.js"><link rel="prefetch" href="/assets/js/46.66ead5ac.js"><link rel="prefetch" href="/assets/js/47.13ba3a60.js"><link rel="prefetch" href="/assets/js/48.cc87de5f.js"><link rel="prefetch" href="/assets/js/49.0d985233.js"><link rel="prefetch" href="/assets/js/5.3c7852ef.js"><link rel="prefetch" href="/assets/js/50.f25489e0.js"><link rel="prefetch" href="/assets/js/51.9d6635ee.js"><link rel="prefetch" href="/assets/js/52.e29dfe30.js"><link rel="prefetch" href="/assets/js/53.de0678ce.js"><link rel="prefetch" href="/assets/js/54.6580c438.js"><link rel="prefetch" href="/assets/js/6.54e1cc95.js"><link rel="prefetch" href="/assets/js/7.53bcef6c.js"><link rel="prefetch" href="/assets/js/8.37dd4b7c.js"><link rel="prefetch" href="/assets/js/9.26cfd48c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f841f567.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">å°ç†Šçš„æŠ€æœ¯æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end/" class="nav-link router-link-active">
  ğŸ¨å‰ç«¯
</a></div><div class="nav-item"><a href="/back-end/" class="nav-link">
  ğŸ’»åç«¯
</a></div><div class="nav-item"><a href="/office/" class="nav-link">
  ğŸ¢åŠå…¬
</a></div><div class="nav-item"><a href="/practice/" class="nav-link">
  ğŸš€å®æˆ˜
</a></div><div class="nav-item"><a href="/general/" class="nav-link">
  ğŸ“é€šç”¨
</a></div><div class="nav-item"><a href="/general/fast.html" class="nav-link">
  âš¡å¿«é€Ÿç¬”è®°
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ¦‰è¿‘æœŸé‡ç‚¹" class="dropdown-title"><span class="title">ğŸ¦‰è¿‘æœŸé‡ç‚¹</span> <span class="arrow down"></span></button> <button type="button" aria-label="ğŸ¦‰è¿‘æœŸé‡ç‚¹" class="mobile-dropdown-title"><span class="title">ğŸ¦‰è¿‘æœŸé‡ç‚¹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/practice/book.html" class="nav-link">
  ğŸ“šå¸¸ç”¨æŠ€æœ¯ä¹¦ç±
</a></li><li class="dropdown-item"><!----> <a href="/office/other.html" class="nav-link">
  ğŸ’¼å¸¸ç”¨åŠå…¬æŠ€å·§
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="â­ï¸èµ„æº" class="dropdown-title"><span class="title">â­ï¸èµ„æº</span> <span class="arrow down"></span></button> <button type="button" aria-label="â­ï¸èµ„æº" class="mobile-dropdown-title"><span class="title">â­ï¸èµ„æº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.birdiesearch.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å°é¸Ÿæœç´¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://salttiger.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æ¯å¤©ä¸€æœ¬ç¼–ç¨‹ä¹¦
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://metaso.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ç§˜å¡”AIæœç´¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end/" class="nav-link router-link-active">
  ğŸ¨å‰ç«¯
</a></div><div class="nav-item"><a href="/back-end/" class="nav-link">
  ğŸ’»åç«¯
</a></div><div class="nav-item"><a href="/office/" class="nav-link">
  ğŸ¢åŠå…¬
</a></div><div class="nav-item"><a href="/practice/" class="nav-link">
  ğŸš€å®æˆ˜
</a></div><div class="nav-item"><a href="/general/" class="nav-link">
  ğŸ“é€šç”¨
</a></div><div class="nav-item"><a href="/general/fast.html" class="nav-link">
  âš¡å¿«é€Ÿç¬”è®°
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ¦‰è¿‘æœŸé‡ç‚¹" class="dropdown-title"><span class="title">ğŸ¦‰è¿‘æœŸé‡ç‚¹</span> <span class="arrow down"></span></button> <button type="button" aria-label="ğŸ¦‰è¿‘æœŸé‡ç‚¹" class="mobile-dropdown-title"><span class="title">ğŸ¦‰è¿‘æœŸé‡ç‚¹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/practice/book.html" class="nav-link">
  ğŸ“šå¸¸ç”¨æŠ€æœ¯ä¹¦ç±
</a></li><li class="dropdown-item"><!----> <a href="/office/other.html" class="nav-link">
  ğŸ’¼å¸¸ç”¨åŠå…¬æŠ€å·§
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="â­ï¸èµ„æº" class="dropdown-title"><span class="title">â­ï¸èµ„æº</span> <span class="arrow down"></span></button> <button type="button" aria-label="â­ï¸èµ„æº" class="mobile-dropdown-title"><span class="title">â­ï¸èµ„æº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.birdiesearch.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å°é¸Ÿæœç´¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://salttiger.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æ¯å¤©ä¸€æœ¬ç¼–ç¨‹ä¹¦
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://metaso.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ç§˜å¡”AIæœç´¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/front-end/javascript.html" class="sidebar-link">Javascript/ECMAScript ç›¸å…³æŠ€æœ¯</a></li><li><a href="/front-end/typescript.html" class="sidebar-link">å­¦ä¹  Typescript å®æˆ˜å¼€å‘</a></li><li><a href="/front-end/node.html" class="sidebar-link">Node.jsæ·±å…¥æµ…å‡º</a></li><li><a href="/front-end/css.html" class="sidebar-link">css å®æˆ˜å­¦ä¹ </a></li><li><a href="/front-end/react.html" class="sidebar-link">React17+React Hook+TS4 æœ€ä½³å®è·µ</a></li><li><a href="/front-end/vue.html" class="sidebar-link">Vueé¡¹ç›®å®æˆ˜</a></li><li><a href="/front-end/es6.html" class="sidebar-link">æ·±å…¥ç†è§£ES6</a></li><li><a href="/front-end/babel.html" class="sidebar-link">Babelè¯¦ç»†å­¦ä¹ </a></li><li><a href="/front-end/electron.html" class="sidebar-link">electronå®æˆ˜</a></li><li><a href="/front-end/pattern.html" class="sidebar-link">å‰ç«¯è®¾è®¡æ¨¡å¼</a></li><li><a href="/front-end/design.html" class="sidebar-link">å‰ç«¯è®¾è®¡ä¸å¯è§†åŒ–</a></li><li><a href="/front-end/vuepress.html" class="sidebar-link">vuepress åŸºæœ¬é…ç½®</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react-ä¸-antd-å¼€å‘å‰ç«¯é¡µé¢"><a href="#react-ä¸-antd-å¼€å‘å‰ç«¯é¡µé¢" class="header-anchor">#</a> React ä¸ Antd å¼€å‘å‰ç«¯é¡µé¢</h1> <h2 id="react-å®‰è£…"><a href="#react-å®‰è£…" class="header-anchor">#</a> React å®‰è£…</h2> <p>React ç”Ÿæ€: React + React-Router + Redux + Axios + Babel + Webpack<br>
React æ˜¯å£°æ˜å¼å®ç°, ä½¿ç”¨ yarn, é€šè¿‡<code>npm install yarn -g</code>å®‰è£… yarn æœ€æ–°ç¨³å®šç‰ˆæœ¬.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åˆå§‹åŒ–é¡¹ç›®</span>
yarn init
<span class="token comment">// æ–°å¢åŒ…</span>
yarn add
<span class="token comment">// åˆ é™¤åŒ…</span>
yarn remove
<span class="token comment">// å®‰è£…é¡¹ç›®æ‰€æœ‰ä¾èµ–</span>
yarn <span class="token operator">/</span> yarn install
</code></pre></div><p>ä½¿ç”¨å‘½ä»¤åˆå§‹åŒ–é¡¹ç›®<code>npx create-react-app my-antd</code>, å¦‚æœé¡¹ç›®è¿è¡Œä¸èµ·æ¥, è€ƒè™‘æ˜¯ä¸æ˜¯ä¸Šå±‚æ–‡ä»¶å¤¹æœ‰æ²¡æœ‰<code>node_modules</code>æ–‡ä»¶å¤¹, å¦åˆ™ä¼šæŠ¥é”™.<br>
é»˜è®¤ react ä¼šå¯ç”¨ä¸¥æ ¼æ¨¡å¼ StrictMode,StrictMode æ˜¯ä¸€ä¸ªç”¨æ¥çªå‡ºæ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸­æ½œåœ¨é—®é¢˜çš„å·¥å…·ã€‚ä¸¥æ ¼æ¨¡å¼æ£€æŸ¥ä»…åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œ, StrictMode ç›®å‰æœ‰åŠ©äºï¼š</p> <ul><li>è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ</li> <li>å…³äºä½¿ç”¨è¿‡æ—¶å­—ç¬¦ä¸² ref API çš„è­¦å‘Š</li> <li>å…³äºä½¿ç”¨åºŸå¼ƒçš„ findDOMNode æ–¹æ³•çš„è­¦å‘Š</li> <li>æ£€æµ‹æ„å¤–çš„å‰¯ä½œç”¨</li> <li>æ£€æµ‹è¿‡æ—¶çš„ context API</li></ul> <h2 id="é¦–é¡µå¼€å‘"><a href="#é¦–é¡µå¼€å‘" class="header-anchor">#</a> é¦–é¡µå¼€å‘</h2> <h3 id="å¢åŠ -less-æ”¯æŒ"><a href="#å¢åŠ -less-æ”¯æŒ" class="header-anchor">#</a> å¢åŠ  less æ”¯æŒ</h3> <p>å®‰è£…ä¾èµ–:<code>yarn add react-router-dom@4.2.2 axios less@2.7.3 less-loader@4.1.0 --save</code>, å…¶ä¸­<code>less</code>å’Œ<code>less-loader</code>éƒ½éœ€è¦å®‰è£….</p> <p>ç„¶åè¿è¡Œ<code>yarn eject</code>æš´éœ²åŸæœ¬çš„<code>webpack</code>è®¾ç½®, æš´éœ²ä¹‹å‰éœ€è¦ä½¿ç”¨ git ä¿å­˜å½“å‰æƒ…å†µ, å¦åˆ™è¿è¡Œ eject ä¼šæŠ¥é”™.<br>
åœ¨<code>config/webpack.config.js</code>çš„é…ç½®æ–‡ä»¶æ±‡æ€», åœ¨<code>module.rules</code>ä¸‹é¢çš„<code>oneOf:[]</code>æ•°ç»„ä¸­, ä»¿ç…§<code>cssRegex</code>å¢åŠ <code>less</code>è§£æå™¨, å¦‚ä¸‹æ‰€ç¤º:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  exclude<span class="token operator">:</span> cssModuleRegex<span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token function">getStyleLoaders</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    importLoaders<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    sourceMap<span class="token operator">:</span> isEnvProduction <span class="token operator">&amp;&amp;</span> shouldUseSourceMap<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// Don't consider CSS imports dead code even if the</span>
  <span class="token comment">// containing package claims to have no side effects.</span>
  <span class="token comment">// Remove this when webpack adds a warning or an error for this.</span>
  <span class="token comment">// See https://github.com/webpack/webpack/issues/6571</span>
  sideEffects<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>ç”±äº<code>use</code>ä¸­è°ƒç”¨çš„æ˜¯<code>getStyleLoaders</code>å‡½æ•°, å› æ­¤è¿˜éœ€è¦ä¿®æ”¹<code>getStyleLoaders</code>, åœ¨<code>loaders</code>å˜é‡çš„æœ€åå¢åŠ </p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  loader<span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'less-loader'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>å› ä¸º loaders æ˜¯ä»åå‘å‰è§£æçš„, æ‰€ä»¥éœ€è¦åŠ åœ¨æœ€å¼€å¤´, å…ˆè§£æ less, ç„¶ååœ¨è§£æ css ç­‰</p> <h3 id="å®ç°æŒ‰éœ€åŠ è½½"><a href="#å®ç°æŒ‰éœ€åŠ è½½" class="header-anchor">#</a> å®ç°æŒ‰éœ€åŠ è½½</h3> <p>antd å®˜ç½‘æä¾›äº†<a href="https://ant.design/docs/react/getting-started-cn#%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD" target="_blank" rel="noopener noreferrer">æŒ‰éœ€åŠ è½½<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„è¯´æ˜, é¦–å…ˆéœ€è¦å®‰è£…<code>npm install babel-plugin-import --save-dev</code>, ç„¶åä¿®æ”¹é…ç½®, è¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨<code>webpack</code>ä¸­è¿›è¡Œä¿®æ”¹, ä¿®æ”¹çš„åœ°æ–¹ä½äºç³»ç»Ÿè°ƒç”¨<code>babel-loader</code>æ—¶, å³<code>loader: require.resolve('babel-loader')</code>, æ­¤æ—¶åœ¨æ’ä»¶æ ä¸­åŠ å…¥<code>['import', { libraryName: 'antd', style: true }]</code>, å³å¯å®ç°æŒ‰éœ€åŠ è½½ css, ä¸éœ€è¦åœ¨é¡µé¢ä¸­å†å†™<code>import css</code></p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token punctuation">{</span>
  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(js|mjs|jsx|ts|tsx)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  include<span class="token operator">:</span> paths<span class="token punctuation">.</span>appSrc<span class="token punctuation">,</span>
  loader<span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'babel-loader'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  options<span class="token operator">:</span> <span class="token punctuation">{</span>
    customize<span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>
      <span class="token string">'babel-preset-react-app/webpack-overrides'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>
        require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'babel-plugin-named-asset-import'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          loaderMap<span class="token operator">:</span> <span class="token punctuation">{</span>
            svg<span class="token operator">:</span> <span class="token punctuation">{</span>
              ReactComponent<span class="token operator">:</span>
                <span class="token string">'@svgr/webpack?-svgo,+titleProp,+ref![path]'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// ä¸‹é¢æ˜¯å¢åŠ çš„, å®ç°æŒ‰éœ€å¯¼å…¥</span>
      <span class="token punctuation">[</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> libraryName<span class="token operator">:</span> <span class="token string">'antd'</span><span class="token punctuation">,</span> style<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    cacheDirectory<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    cacheCompression<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    compact<span class="token operator">:</span> isEnvProduction<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
### ä½¿ç”¨ aliyun ä¸»é¢˜

åœ¨</span><span class="token template-punctuation string">`</span></span>config<span class="token operator">/</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">çš„ less-loader é…ç½®ä¸­, åˆ©ç”¨</span><span class="token template-punctuation string">`</span></span>modifyVars<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ä¿®æ”¹ç›¸åº”å˜é‡, å³å¯æ”¹å˜ä¸»é¢˜é¢œè‰².

</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>js
<span class="token punctuation">{</span>
  loader<span class="token operator">:</span> <span class="token string">'less-loader'</span><span class="token punctuation">,</span>
  options<span class="token operator">:</span> <span class="token punctuation">{</span>
    modules<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    modifyVars<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'@font-size-sm'</span><span class="token operator">:</span> <span class="token string">'12px'</span><span class="token punctuation">,</span>
      <span class="token string">'@font-size-base'</span><span class="token operator">:</span> <span class="token string">'12px'</span><span class="token punctuation">,</span>
      <span class="token string">'@primary-color'</span><span class="token operator">:</span> <span class="token string">'#0070cc'</span><span class="token punctuation">,</span>
      <span class="token string">'@border-radius-base'</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token string">'@border-radius-sm'</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token string">'@text-color'</span><span class="token operator">:</span> <span class="token string">'fade(#000, 65%)'</span><span class="token punctuation">,</span>
      <span class="token string">'@text-color-secondary'</span><span class="token operator">:</span> <span class="token string">'fade(#000, 45%)'</span><span class="token punctuation">,</span>
      <span class="token string">'@background-color-base'</span><span class="token operator">:</span> <span class="token string">'hsv(0, 0, 96%)'</span><span class="token punctuation">,</span>
      <span class="token string">'@success-color'</span><span class="token operator">:</span> <span class="token string">'#1e8e3e'</span><span class="token punctuation">,</span>
      <span class="token string">'@error-color'</span><span class="token operator">:</span> <span class="token string">'#d93026'</span><span class="token punctuation">,</span>
      <span class="token string">'@warning-color'</span><span class="token operator">:</span> <span class="token string">'#ffc440'</span><span class="token punctuation">,</span>
      <span class="token string">'@info-color'</span><span class="token operator">:</span> <span class="token string">'@primary-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@danger-color'</span><span class="token operator">:</span> <span class="token string">'@error-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@processing-color'</span><span class="token operator">:</span> <span class="token string">'@primary-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@border-color-base'</span><span class="token operator">:</span> <span class="token string">'#dedede'</span><span class="token punctuation">,</span>
      <span class="token string">'@border-color-split'</span><span class="token operator">:</span> <span class="token string">'#dedede'</span><span class="token punctuation">,</span>
      <span class="token string">'@outline-width'</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token string">'@outline-color'</span><span class="token operator">:</span> <span class="token string">'#737373'</span><span class="token punctuation">,</span>
      <span class="token string">'@input-height-lg'</span><span class="token operator">:</span> <span class="token string">'36px'</span><span class="token punctuation">,</span>
      <span class="token string">'@input-height-base'</span><span class="token operator">:</span> <span class="token string">'32px'</span><span class="token punctuation">,</span>
      <span class="token string">'@input-height-sm'</span><span class="token operator">:</span> <span class="token string">'24px'</span><span class="token punctuation">,</span>
      <span class="token string">'@input-hover-border-color'</span><span class="token operator">:</span> <span class="token string">'#737373'</span><span class="token punctuation">,</span>
      <span class="token string">'@form-item-margin-bottom'</span><span class="token operator">:</span> <span class="token string">'16px'</span><span class="token punctuation">,</span>
      <span class="token string">'@btn-default-bg'</span><span class="token operator">:</span> <span class="token string">'#fafafa'</span><span class="token punctuation">,</span>
      <span class="token string">'@btn-default-border'</span><span class="token operator">:</span> <span class="token string">'#dedede'</span><span class="token punctuation">,</span>
      <span class="token string">'@btn-danger-color'</span><span class="token operator">:</span> <span class="token string">'#fff'</span><span class="token punctuation">,</span>
      <span class="token string">'@btn-danger-bg'</span><span class="token operator">:</span> <span class="token string">'@error-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@btn-danger-border'</span><span class="token operator">:</span> <span class="token string">'@error-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@switch-color'</span><span class="token operator">:</span> <span class="token string">'@success-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@table-header-bg'</span><span class="token operator">:</span> <span class="token string">'#fafafa'</span><span class="token punctuation">,</span>
      <span class="token string">'@table-row-hover-bg'</span><span class="token operator">:</span> <span class="token string">'#fafafa'</span><span class="token punctuation">,</span>
      <span class="token string">'@table-padding-vertical'</span><span class="token operator">:</span> <span class="token string">'15px'</span><span class="token punctuation">,</span>
      <span class="token string">'@badge-color'</span><span class="token operator">:</span> <span class="token string">'@error-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@breadcrumb-base-color'</span><span class="token operator">:</span> <span class="token string">'@text-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@breadcrumb-last-item-color'</span><span class="token operator">:</span> <span class="token string">'@text-color-secondary'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-rail-background-color'</span><span class="token operator">:</span> <span class="token string">'@background-color-base'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-rail-background-color-hover'</span><span class="token operator">:</span> <span class="token string">'#e1e1e1'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-track-background-color'</span><span class="token operator">:</span> <span class="token string">'@primary-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-track-background-color-hover'</span><span class="token operator">:</span> <span class="token string">'@primary-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-handle-border-width'</span><span class="token operator">:</span> <span class="token string">'1px'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-handle-color'</span><span class="token operator">:</span> <span class="token string">'#dedede'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-handle-color-hover'</span><span class="token operator">:</span> <span class="token string">'#dedede'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-handle-color-focus'</span><span class="token operator">:</span> <span class="token string">'#dedede'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-handle-color-tooltip-open'</span><span class="token operator">:</span> <span class="token string">'#ddd'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-handle-color-focus-shadow'</span><span class="token operator">:</span> <span class="token string">'transparent'</span><span class="token punctuation">,</span>
      <span class="token string">'@slider-handle-shadow'</span><span class="token operator">:</span> <span class="token string">'1px 1px 4px 0 rgba(0,0,0,.13)'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-success-border-color'</span><span class="token operator">:</span> <span class="token string">'#dff4e5'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-success-bg-color'</span><span class="token operator">:</span> <span class="token string">'#dff4e5'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-info-border-color'</span><span class="token operator">:</span> <span class="token string">'#e5f3ff'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-info-bg-color'</span><span class="token operator">:</span> <span class="token string">'#e5f3ff'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-error-border-color'</span><span class="token operator">:</span> <span class="token string">'#fcebea'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-error-bg-color'</span><span class="token operator">:</span> <span class="token string">'#fcebea'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-warning-border-color'</span><span class="token operator">:</span> <span class="token string">'#fff7db'</span><span class="token punctuation">,</span>
      <span class="token string">'@alert-warning-bg-color'</span><span class="token operator">:</span> <span class="token string">'#fff7db'</span><span class="token punctuation">,</span>
      <span class="token string">'@radio-button-bg'</span><span class="token operator">:</span> <span class="token string">'transparent'</span><span class="token punctuation">,</span>
      <span class="token string">'@radio-button-checked-bg'</span><span class="token operator">:</span> <span class="token string">'transparent'</span><span class="token punctuation">,</span>
      <span class="token string">'@progress-radius'</span><span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>
      <span class="token string">'@tabs-card-gutter'</span><span class="token operator">:</span> <span class="token string">'-1px'</span><span class="token punctuation">,</span>
      <span class="token string">'@tabs-card-tab-active-border-top'</span><span class="token operator">:</span> <span class="token string">'2px solid @primary-color'</span><span class="token punctuation">,</span>
      <span class="token string">'@layout-body-background'</span><span class="token operator">:</span> <span class="token string">'#fafafa'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ·»åŠ è£…é¥°å™¨æ”¯æŒ"><a href="#æ·»åŠ è£…é¥°å™¨æ”¯æŒ" class="header-anchor">#</a> æ·»åŠ è£…é¥°å™¨æ”¯æŒ</h3> <p>é¦–å…ˆå®‰è£… babel çš„è£…é¥°å™¨æ”¯æŒæ’ä»¶<code>yarn add @babel/plugin-proposal-decorators</code></p> <p>å°†é¡¹ç›®ä¸­ package.json ä¸­çš„ babel ä¾èµ–ä¿®æ”¹ä¸ºï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;babel&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>
        <span class="token string">&quot;@babel/plugin-proposal-decorators&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;legacy&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;react-app&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>è¿™æ ·å°±å¯ä»¥ä½¿ç”¨è£…é¥°å™¨è¯­æ³•äº†.</p> <h2 id="ä½¿ç”¨çŠ¶æ€ç®¡ç†-mobx-æ’ä»¶"><a href="#ä½¿ç”¨çŠ¶æ€ç®¡ç†-mobx-æ’ä»¶" class="header-anchor">#</a> ä½¿ç”¨çŠ¶æ€ç®¡ç† mobx æ’ä»¶</h2> <blockquote><p>MobX æ˜¯ä¸€ä¸ªç®€å•ã€æ–¹ä¾¿æ‰©å±•ã€ä¹…ç»è€ƒéªŒçš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆ.</p></blockquote> <h3 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="header-anchor">#</a> æ ¸å¿ƒæ€æƒ³</h3> <p>çŠ¶æ€æ˜¯æ¯ä¸ªåº”ç”¨ç¨‹åºçš„æ ¸å¿ƒï¼Œæ²¡æœ‰æ¯”åˆ›å»ºä¸ä¸€è‡´çš„çŠ¶æ€æˆ–ä¸å¾˜å¾Šçš„å±€éƒ¨å˜é‡ä¸åŒæ­¥çš„çŠ¶æ€æ›´å¿«çš„æ–¹æ³•æ¥åˆ›å»ºæœ‰ç¼ºé™·çš„ï¼Œéš¾ä»¥ç®¡ç†çš„åº”ç”¨ç¨‹åºã€‚å› æ­¤ï¼Œè®¸å¤šçŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆè¯•å›¾é™åˆ¶ä¿®æ”¹çŠ¶æ€çš„æ–¹å¼ï¼Œä¾‹å¦‚é€šè¿‡ä½¿çŠ¶æ€ä¸å¯å˜ã€‚ä½†è¿™å¸¦æ¥äº†æ–°çš„é—®é¢˜ã€‚æ•°æ®éœ€è¦è§„èŒƒåŒ–ï¼Œæ— æ³•å†ç¡®ä¿å‚ç…§å®Œæ•´æ€§ï¼Œå› æ­¤ä½¿ç”¨åŠŸèƒ½å¼ºå¤§çš„æ¦‚å¿µï¼ˆä¾‹å¦‚åŸå‹ï¼‰å‡ ä¹å˜å¾—ä¸å¯èƒ½ã€‚</p> <p>MobX é€šè¿‡è§£å†³æ ¹æœ¬é—®é¢˜è€Œä½¿çŠ¶æ€ç®¡ç†å†æ¬¡å˜å¾—ç®€å•ï¼šå®ƒä½¿å¾—ä¸å¯èƒ½äº§ç”Ÿä¸ä¸€è‡´çš„çŠ¶æ€ã€‚å®ç°è¿™ä¸€ç›®æ ‡çš„ç­–ç•¥å¾ˆç®€å•ï¼š ç¡®ä¿æ‰€æœ‰å¯ä»¥ä»åº”ç”¨ç¨‹åºçŠ¶æ€æ´¾ç”Ÿçš„å†…å®¹éƒ½å°†è¢«è‡ªåŠ¨æ´¾ç”Ÿã€‚</p> <p>ä»æ¦‚å¿µä¸Šè®²ï¼ŒMobX å°†æ‚¨çš„åº”ç”¨ç¨‹åºè§†ä¸ºç”µå­è¡¨æ ¼ã€‚<br> <img src="https://s1.ax1x.com/2020/05/03/YpSR8H.png" alt="mobxæ ¸å¿ƒæ€æƒ³"></p> <ol><li>é¦–å…ˆï¼Œå­˜åœ¨åº”ç”¨ç¨‹åºçŠ¶æ€ã€‚å¯¹è±¡ï¼Œæ•°ç»„ï¼ŒåŸºå…ƒï¼Œå¼•ç”¨çš„å›¾å½¢æ„æˆäº†åº”ç”¨ç¨‹åºçš„æ¨¡å‹ã€‚è¿™äº›å€¼æ˜¯åº”ç”¨ç¨‹åºçš„â€œæ•°æ®å•å…ƒâ€ã€‚</li> <li>å…¶æ¬¡æ˜¯æ¨å¯¼ã€‚åŸºæœ¬ä¸Šï¼Œä»»ä½•å¯ä»¥æ ¹æ®åº”ç”¨ç¨‹åºçŠ¶æ€è‡ªåŠ¨è®¡ç®—çš„å€¼ã€‚è¿™äº›æ´¾ç”Ÿå€¼æˆ–è®¡ç®—å€¼çš„èŒƒå›´ä»ç®€å•çš„å€¼ï¼ˆä¾‹å¦‚å¾…åŠäº‹é¡¹çš„æ•°é‡ï¼‰åˆ°å¤æ‚çš„ä¸œè¥¿ï¼ˆå¦‚å¾…åŠäº‹é¡¹çš„å¯è§† HTML è¡¨ç¤ºï¼‰ã€‚ç”¨ç”µå­è¡¨æ ¼æœ¯è¯­ï¼šè¿™äº›æ˜¯æ‚¨çš„åº”ç”¨ç¨‹åºçš„å…¬å¼å’Œå›¾è¡¨ã€‚</li> <li>ååº”ä¸æ¨å¯¼éå¸¸ç›¸ä¼¼ã€‚ä¸»è¦åŒºåˆ«åœ¨äºè¿™äº›å‡½æ•°ä¸ä¼šäº§ç”Ÿå€¼ã€‚ç›¸åï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨è¿è¡Œä»¥æ‰§è¡ŒæŸäº›ä»»åŠ¡ã€‚é€šå¸¸ï¼Œè¿™ä¸ I / O æœ‰å…³ã€‚ä»–ä»¬ç¡®ä¿ DOM æ›´æ–°æˆ–åœ¨æ­£ç¡®çš„æ—¶é—´è‡ªåŠ¨å‘å‡ºç½‘ç»œè¯·æ±‚ã€‚</li> <li>æœ€åæœ‰åŠ¨ä½œã€‚è¡ŒåŠ¨æ˜¯æ”¹å˜çŠ¶æ€çš„ä¸€åˆ‡ã€‚MobX å°†ç¡®ä¿ç”±æ‚¨çš„æ“ä½œå¼•èµ·çš„å¯¹åº”ç”¨ç¨‹åºçŠ¶æ€çš„æ‰€æœ‰æ›´æ”¹éƒ½å°†è¢«æ‰€æœ‰æ´¾ç”Ÿå’Œååº”è‡ªåŠ¨å¤„ç†ã€‚åŒæ­¥ä¸”æ— æ•…éšœã€‚</li></ol> <h3 id="å¾…åŠäº‹é¡¹ç¤ºä¾‹"><a href="#å¾…åŠäº‹é¡¹ç¤ºä¾‹" class="header-anchor">#</a> å¾…åŠäº‹é¡¹ç¤ºä¾‹</h3> <p>åœ¨æ²¡æœ‰ç”¨ mobx çš„æ—¶å€™å®ç°å¾…åŠäº‹é¡¹çš„å‚¨å­˜, ç¤ºä¾‹ä»£ç å¦‚ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">TodoStore</span> <span class="token punctuation">{</span>
  todos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// å†…éƒ¨å±æ€§, å­˜å‚¨æ‰€æœ‰çš„å¾…åŠäº‹é¡¹</span>

  <span class="token comment">// è·å¾—å·²ç»å®Œæˆçš„å¾…åŠäº‹é¡¹æ•°é‡</span>
  <span class="token keyword">get</span> <span class="token function">completedTodosCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
  <span class="token punctuation">}</span>
  <span class="token comment">// æŠ¥å‘Šå½“å‰çš„å¾…åŠäº‹é¡¹æƒ…å†µ</span>
  <span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'&lt;æ— &gt;'</span>
    <span class="token keyword">const</span> nextTodo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ä¸‹ä¸€ä¸ªäº‹é¡¹: &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nextTodo <span class="token operator">?</span> nextTodo<span class="token punctuation">.</span>task <span class="token operator">:</span> <span class="token string">'&lt;æ— &gt;'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;. </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å½“å‰è¿›åº¦: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>completedTodosCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å¢åŠ å¾…åŠäº‹é¡¹, é»˜è®¤completed(å®Œæˆ)ä¸ºå¦,assignee(å§”æ‰˜äºº)ä¸ºç©º</span>
  <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token parameter">task</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      task<span class="token operator">:</span> task<span class="token punctuation">,</span>
      completed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      assignee<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// æ–°å»ºå¾…åŠäº‹é¡¹å‚¨å­˜å®ä¾‹</span>
<span class="token keyword">const</span> todoStore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TodoStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>æˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†ä¸€ä¸ª å¸¦æœ‰ <code>todos</code>é›†åˆçš„<code>todoStore</code>çš„å®ä¾‹ã€‚æ˜¯æ—¶å€™ç”¨ä¸€äº›å¯¹è±¡å¡«å……<code>todoStore</code>äº†ã€‚ä¸ºäº†ç¡®ä¿æˆ‘ä»¬çœ‹åˆ°æ›´æ”¹çš„æ•ˆæœï¼Œæˆ‘ä»¬ <code>todoStore.report</code>æ–¹æ³•åœ¨æ¯æ¬¡æ›´æ”¹åè°ƒç”¨å¹¶è®°å½•ä¸‹æ¥ã€‚è¯·æ³¨æ„ï¼ŒæŠ¥è¡¨æœ‰æ„å§‹ç»ˆä»…æ‰“å°ç¬¬ä¸€ä¸ªä»»åŠ¡ã€‚å®ƒä½¿è¯¥ç¤ºä¾‹æœ‰äº›è™šå‡ï¼Œä½†æ˜¯æ­£å¦‚æ‚¨å°†åœ¨ä¸‹é¢çœ‹åˆ°çš„é‚£æ ·ï¼Œå®ƒå¾ˆå¥½åœ°è¯æ˜äº† MobX çš„ä¾èµ–é¡¹è·Ÿè¸ªæ˜¯åŠ¨æ€çš„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>todoStore<span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token string">'read MobX tutorial'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>todoStore<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// è¾“å‡º:ä¸‹ä¸€ä¸ªäº‹é¡¹: &quot;read MobX tutorial&quot;. å½“å‰è¿›åº¦: 0/1</span>

todoStore<span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token string">'try MobX'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>todoStore<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// è¾“å‡º:ä¸‹ä¸€ä¸ªäº‹é¡¹: &quot;read MobX tutorial&quot;. å½“å‰è¿›åº¦: 0/2</span>

todoStore<span class="token punctuation">.</span>todos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>completed <span class="token operator">=</span> <span class="token boolean">true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>todoStore<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// è¾“å‡º: ä¸‹ä¸€ä¸ªäº‹é¡¹: &quot;try MobX&quot;. å½“å‰è¿›åº¦: 1/2</span>

todoStore<span class="token punctuation">.</span>todos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>task <span class="token operator">=</span> <span class="token string">'try MobX in own project'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>todoStore<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// è¾“å‡º: ä¸‹ä¸€ä¸ªäº‹é¡¹: &quot;try MobX in own project&quot;. å½“å‰è¿›åº¦: 1/2</span>

todoStore<span class="token punctuation">.</span>todos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>task <span class="token operator">=</span> <span class="token string">'grok MobX tutorial'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>todoStore<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// è¾“å‡º: ä¸‹ä¸€ä¸ªäº‹é¡¹: &quot;try MobX in own project&quot;. å½“å‰è¿›åº¦: 1/2</span>
</code></pre></div><h3 id="å˜æˆå“åº”å¼"><a href="#å˜æˆå“åº”å¼" class="header-anchor">#</a> å˜æˆå“åº”å¼</h3> <p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ­¤ä»£ç æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸å¿…æ˜¾å¼è°ƒç”¨<code>report()</code> ï¼Œè€Œå¯ä»¥å£°æ˜æˆ‘ä»¬å¸Œæœ›åœ¨æ¯æ¬¡çŠ¶æ€æ›´æ”¹æ—¶è°ƒç”¨å®ƒå‘¢ï¼Ÿè¿™å°†ä½¿æˆ‘ä»¬å…äºä»ä»£ç åº“ä¸­å¯èƒ½å½±å“æŠ¥å‘Šçš„ä»»ä½•ä½ç½®è¿›è¡Œè°ƒç”¨<code>report()</code>çš„è´£ä»»ã€‚æˆ‘ä»¬å¸Œæœ›ç¡®ä¿å·²æ‰“å°æœ€æ–°æŠ¥å‘Šã€‚ä½†æ˜¯æˆ‘ä»¬ä¸æƒ³è¢«ç»„ç»‡èµ·æ¥æ‰“æ‰°ã€‚</p> <p>å¹¸è¿çš„æ˜¯ï¼Œè¿™æ­£æ˜¯ <code>MobX</code> å¯ä»¥ä¸ºæ‚¨åšçš„ã€‚è‡ªåŠ¨æ‰§è¡Œä»…å–å†³äºçŠ¶æ€çš„ä»£ç ã€‚è¿™æ ·æˆ‘ä»¬çš„<code>report()``åŠŸèƒ½å°±å¯ä»¥è‡ªåŠ¨æ›´æ–°ï¼Œå°±åƒç”µå­è¡¨æ ¼ä¸­çš„å›¾è¡¨ä¸€æ ·ã€‚ä¸ºæ­¤ï¼ŒTodoStore</code> å¿…é¡»å˜å¾—å¯è§‚å¯Ÿï¼Œä»¥ä¾¿ <code>MobX</code> å¯ä»¥è·Ÿè¸ªæ‰€æœ‰æ­£åœ¨è¿›è¡Œçš„æ›´æ”¹ã€‚è®©æˆ‘ä»¬æ›´æ”¹ç±»ä»¥ä½¿å…¶è¾¾åˆ°ç›®çš„ã€‚</p> <p>åŒæ ·ï¼Œè¯¥ <code>completedTodosCount</code> å±æ€§å¯ä»¥è‡ªåŠ¨ä»å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­æ´¾ç”Ÿã€‚é€šè¿‡ä½¿ç”¨<code>@observable</code> å’Œ<code>@computed</code> è£…é¥°å™¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¹è±¡ä¸Šå¼•å…¥å¯è§‚å¯Ÿçš„å±æ€§ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">ObservableTodoStore</span> <span class="token punctuation">{</span>
  @observable todos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  @observable pendingRequests <span class="token operator">=</span> <span class="token number">0</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mobx<span class="token punctuation">.</span><span class="token function">autorun</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>report<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  @computed <span class="token keyword">get</span> <span class="token function">completedTodosCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
  <span class="token punctuation">}</span>

  @computed <span class="token keyword">get</span> <span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'&lt;æ— &gt;'</span>
    <span class="token keyword">const</span> nextTodo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ä¸‹ä¸€ä¸ªå¾…åŠäº‹é¡¹: &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nextTodo <span class="token operator">?</span> nextTodo<span class="token punctuation">.</span>task <span class="token operator">:</span> <span class="token string">'&lt;æ— &gt;'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;. </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å½“å‰è¿›åº¦: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>completedTodosCount<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token parameter">task</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      task<span class="token operator">:</span> task<span class="token punctuation">,</span>
      completed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      assignee<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> observableTodoStore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObservableTodoStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™å°±å¯ä»¥äº†ï¼æˆ‘ä»¬å°†ä¸€äº›å±æ€§æ ‡è®°ä¸º<code>@observable</code> å‘ MobX å‘å‡ºä¿¡å·ï¼Œè¿™äº›å€¼å¯ä»¥éšæ—¶é—´å˜åŒ–ã€‚ç”¨<code>@computed</code> è£…é¥°è®¡ç®—å¼, è®¡ç®—çŠ¶æ€å˜åŒ–åçš„å€¼ã€‚</p> <p>ç›®å‰è¿˜æœªä½¿ç”¨<code>pendingRequests</code>ä¸<code>assignee</code>å±æ€§ï¼Œä½†å°†åœ¨æœ¬æ•™ç¨‹åé¢ä½¿ç”¨ã€‚ä¸ºç®€æ´èµ·è§ï¼Œæ­¤é¡µé¢ä¸Šçš„æ‰€æœ‰ç¤ºä¾‹å‡ä½¿ç”¨ ES6ï¼ŒJSX å’Œè£…é¥°å™¨ã€‚ä½†æ˜¯ä¸ç”¨æ‹…å¿ƒï¼ŒMobX ä¸­çš„æ‰€æœ‰è£…é¥°å™¨éƒ½æœ‰å¯¹åº”çš„ ES5ã€‚</p> <p>åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå°å‡½æ•°ï¼Œç”¨äºæ‰“å° report å¹¶å°†å…¶åŒ…è£…åœ¨<code>autorun</code>å‡½æ•°ä¸­ã€‚<code>autorun</code>å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªå“åº”ï¼Œè¯¥å“åº”è¿è¡Œä¸€æ¬¡ï¼Œç„¶ååœ¨è¯¥å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„ä»»ä½•å¯è§‚å¯Ÿæ•°æ®å‘ç”Ÿæ›´æ”¹æ—¶è‡ªåŠ¨é‡æ–°è¿è¡Œã€‚å› ä¸º report ä½¿ç”¨äº† observable todos å±æ€§ï¼Œå®ƒå°†åœ¨é€‚å½“çš„æ—¶å€™æ‰“å°æŠ¥å‘Šã€‚åœ¨ä¸‹ä¸€ä¸ªæ¸…å•ä¸­å°†è¯æ˜è¿™ä¸€ç‚¹ã€‚åªéœ€æŒ‰ä¸‹è¿è¡ŒæŒ‰é’®ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>observableTodoStore<span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token string">'è¯»ä¸‰ä½“1'</span><span class="token punctuation">)</span>
<span class="token comment">// è¾“å‡º:ä¸‹ä¸€ä¸ªå¾…åŠäº‹é¡¹: &quot;è¯»ä¸‰ä½“1&quot;. å½“å‰è¿›åº¦: 0/1</span>
observableTodoStore<span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token string">'å†™ä»£ç '</span><span class="token punctuation">)</span>
<span class="token comment">// è¾“å‡º: ä¸‹ä¸€ä¸ªå¾…åŠäº‹é¡¹: &quot;è¯»ä¸‰ä½“1&quot;. å½“å‰è¿›åº¦: 0/2</span>
observableTodoStore<span class="token punctuation">.</span>todos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>completed <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token comment">// è¾“å‡º: ä¸‹ä¸€ä¸ªå¾…åŠäº‹é¡¹: &quot;å†™ä»£ç &quot;. å½“å‰è¿›åº¦: 1/2</span>
observableTodoStore<span class="token punctuation">.</span>todos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>task <span class="token operator">=</span> <span class="token string">'å°†ä¸‰ä½“1æ”¹ä¸ºä¸‰ä½“2'</span>
<span class="token comment">// è¾“å‡º: ä¸‹ä¸€ä¸ªå¾…åŠäº‹é¡¹: &quot;å°†ä¸‰ä½“1æ”¹ä¸ºä¸‰ä½“2&quot;. å½“å‰è¿›åº¦: 1/2</span>
observableTodoStore<span class="token punctuation">.</span>todos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>task <span class="token operator">=</span> <span class="token string">'å°†å†™ä»£ç æ”¹ä¸ºè¯»ä»£ç '</span>
<span class="token comment">// æ²¡æœ‰è¾“å‡º</span>
</code></pre></div><p>çº¯ç²¹çš„ä¹è¶£å§ï¼Ÿåœ¨ report æ²¡æœ‰è‡ªåŠ¨æ‰“å°ï¼ŒåŒæ­¥ï¼Œæ— æ³„æ¼ä¸­é—´å€¼ã€‚å¦‚æœä»”ç»†è°ƒæŸ¥æ—¥å¿—ï¼Œæ‚¨å°†çœ‹åˆ°ç¬¬äº”è¡Œæ²¡æœ‰äº§ç”Ÿæ–°çš„æ—¥å¿—è¡Œã€‚å› ä¸ºé‡å‘½åå®é™…ä¸Šå¹¶æ²¡æœ‰æ”¹å˜æŠ¥å‘Šï¼Œä½†æ˜¯æ”¯æŒæ•°æ®å´æ”¹å˜äº†ã€‚å¦ä¸€æ–¹é¢ï¼Œæ›´æ”¹ç¬¬ä¸€ä¸ªå¾…åŠäº‹é¡¹çš„åç§°ç¡®å®ä¼šæ›´æ–°æŠ¥å‘Šï¼Œå› ä¸ºè¯¥åç§°å·²åœ¨æŠ¥å‘Šä¸­ç§¯æä½¿ç”¨ã€‚è¿™å¾ˆå¥½åœ°è¯æ˜äº†ä¸ä»… todos æ•°ç»„æ­£åœ¨è¢«è§‚å¯Ÿ autorunï¼Œè¿˜æœ‰å¾…åŠäº‹é¡¹ä¸­çš„å„ä¸ªå±æ€§ã€‚</p> <h3 id="ä½¿-react-ååº”"><a href="#ä½¿-react-ååº”" class="header-anchor">#</a> ä½¿ React ååº”</h3> <p>å¥½çš„ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åšå‡ºäº†ä¸€ä¸ªæ„šè ¢çš„æŠ¥å‘Šã€‚æ˜¯æ—¶å€™åœ¨è¿™å®¶åŒä¸€ä¸ªå•†åº—å‘¨å›´å»ºç«‹ååº”å¼ç”¨æˆ·ç•Œé¢äº†ã€‚å°½ç®¡æœ‰å®ƒä»¬çš„åå­—ï¼ŒReact ç»„ä»¶å´æ˜¯æ— ååº”çš„ã€‚åŒ…ä¸­çš„@observer è£…é¥°å™¨ mobx-react é€šè¿‡å°† React ç»„ä»¶ render æ–¹æ³•åŒ…è£…åœ¨ä¸­æ¥ä¿®å¤æ­¤é—®é¢˜ï¼Œè¯¥æ–¹æ³• autorun è‡ªåŠ¨ä½¿æ‚¨çš„ç»„ä»¶ä¸çŠ¶æ€ä¿æŒåŒæ­¥ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œè¿™ä¸æˆ‘ä»¬ report ä¹‹å‰æ‰€åšçš„æ²¡ä»€ä¹ˆä¸åŒã€‚</p> <p>ä¸‹ä¸€ä¸ªæ¸…å•å®šä¹‰äº†ä¸€äº› React ç»„ä»¶ã€‚é‚£é‡Œå”¯ä¸€çš„ MobX ä¸œè¥¿æ˜¯@observer è£…é¥°å™¨ã€‚è¿™è¶³ä»¥ç¡®ä¿åœ¨ç›¸å…³æ•°æ®æ›´æ”¹æ—¶æ¯ä¸ªç»„ä»¶éƒ½å•ç‹¬é‡æ–°æ¸²æŸ“ã€‚æ‚¨æ— éœ€å†è°ƒç”¨ setStateï¼Œä¹Ÿä¸å¿…å¼„æ¸…æ¥šå¦‚ä½•ä½¿ç”¨é€‰æ‹©å™¨æˆ–éœ€è¦é…ç½®çš„é«˜é˜¶ç»„ä»¶æ¥è®¢é˜…åº”ç”¨ç¨‹åºçŠ¶æ€çš„é€‚å½“éƒ¨åˆ†ã€‚åŸºæœ¬ä¸Šï¼Œæ‰€æœ‰ç»„ä»¶éƒ½å˜å¾—æ™ºèƒ½ã€‚ç„¶è€Œï¼Œå®ƒä»¬æ˜¯ä»¥æ„šè ¢çš„å£°æ˜æ€§æ–¹å¼å®šä¹‰çš„ã€‚</p> <p>æŒ‰è¿è¡Œä»£ç æŒ‰é’®ä»¥æŸ¥çœ‹ä¸‹é¢çš„ä»£ç ã€‚è¯¥åˆ—è¡¨æ˜¯å¯ç¼–è¾‘çš„ï¼Œå› æ­¤å¯ä»¥éšæ„ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå°è¯•åˆ é™¤æ‰€æœ‰@observer å‘¼å«ï¼Œæˆ–è€…ä»…åˆ é™¤è£…é¥°çš„å‘¼å« TodoViewã€‚æ¯æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œå³ä¾§é¢„è§ˆä¸­çš„æ•°å­—éƒ½ä¼šçªå‡ºæ˜¾ç¤ºã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>@observer
<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>store<span class="token punctuation">.</span>report<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
          <span class="token punctuation">{</span>store<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>TodoView todo<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">}</span> key<span class="token operator">=</span><span class="token punctuation">{</span>idx<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>store<span class="token punctuation">.</span>pendingRequests <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">&lt;</span>marquee<span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>marquee<span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onNewTodo<span class="token punctuation">}</span><span class="token operator">&gt;</span>New Todo<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>small<span class="token operator">&gt;</span> <span class="token punctuation">(</span>double<span class="token operator">-</span>click a todo to edit<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>small<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>RenderCounter <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">onNewTodo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'Enter a new todo:'</span><span class="token punctuation">,</span> <span class="token string">'coffee plz'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

@observer
<span class="token keyword">class</span> <span class="token class-name">TodoView</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> todo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>todo
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>li onDoubleClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onRename<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input
          type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span>
          checked<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onToggleCompleted<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>todo<span class="token punctuation">.</span>task<span class="token punctuation">}</span>
        <span class="token punctuation">{</span>todo<span class="token punctuation">.</span>assignee <span class="token operator">?</span> <span class="token operator">&lt;</span>small<span class="token operator">&gt;</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span>assignee<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>small<span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>RenderCounter <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">onToggleCompleted</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> todo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>todo
    todo<span class="token punctuation">.</span>completed <span class="token operator">=</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed
  <span class="token punctuation">}</span>

  <span class="token function-variable function">onRename</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> todo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>todo
    todo<span class="token punctuation">.</span>task <span class="token operator">=</span> <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'Task name'</span><span class="token punctuation">,</span> todo<span class="token punctuation">.</span>task<span class="token punctuation">)</span> <span class="token operator">||</span> todo<span class="token punctuation">.</span>task
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>TodoList store<span class="token operator">=</span><span class="token punctuation">{</span>observableTodoStore<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'reactjs-app'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="å¸¸ç”¨-api"><a href="#å¸¸ç”¨-api" class="header-anchor">#</a> å¸¸ç”¨ api</h3> <ol><li><p><code>@observable</code>è£…é¥°å™¨, è£…é¥°å™¨å¯ä»¥åœ¨ ES7 æˆ–è€… TypeScript ç±»å±æ€§ä¸­å±æ€§ä½¿ç”¨ï¼Œå°†å…¶è½¬æ¢æˆå¯è§‚å¯Ÿçš„ã€‚@<code>observable</code>å¯ä»¥åœ¨å®ä¾‹å­—æ®µå’Œå±æ€§<code>getter</code>ä¸Šä½¿ç”¨ã€‚å¯¹äºå¯¹è±¡çš„å“ªéƒ¨åˆ†éœ€è¦æˆä¸ºå¯è§‚å¯Ÿçš„ï¼Œ<code>@observable</code>æä¾›äº†ç»†ç²’åº¦çš„æ§åˆ¶ã€‚</p></li> <li><p><code>@computed</code>è£…é¥°å™¨æ¥å£°æ˜å¼çš„åˆ›å»ºè®¡ç®—å±æ€§ã€‚è®¡ç®—å€¼(computed values)æ˜¯å¯ä»¥æ ¹æ®ç°æœ‰çš„çŠ¶æ€æˆ–å…¶å®ƒè®¡ç®—å€¼è¡ç”Ÿå‡ºçš„å€¼ã€‚æ¦‚å¿µä¸Šæ¥è¯´ï¼Œå®ƒä»¬ä¸ excel è¡¨æ ¼ä¸­çš„å…¬å¼ååˆ†ç›¸ä¼¼ã€‚ä¸è¦ä½ä¼°è®¡ç®—å€¼ï¼Œå› ä¸ºå®ƒä»¬æœ‰åŠ©äºä½¿å®é™…å¯ä¿®æ”¹çš„çŠ¶æ€å°½å¯èƒ½çš„å°ã€‚æ­¤å¤–è®¡ç®—å€¼è¿˜æ˜¯é«˜åº¦ä¼˜åŒ–è¿‡çš„ï¼Œæ‰€ä»¥å°½å¯èƒ½çš„å¤šä½¿ç”¨å®ƒä»¬ã€‚<strong>ä¸è¦æŠŠ<code>computed</code>å’Œ<code>autorun</code>ææ··</strong>ã€‚å®ƒä»¬éƒ½æ˜¯å“åº”å¼è°ƒç”¨çš„è¡¨è¾¾å¼ï¼Œä½†æ˜¯ï¼Œ<em>å¦‚æœä½ æƒ³å“åº”å¼çš„äº§ç”Ÿä¸€ä¸ªå¯ä»¥è¢«å…¶å®ƒ observer ä½¿ç”¨çš„å€¼ï¼Œè¯·ä½¿ç”¨ <code>@computed</code></em>ï¼Œå¦‚æœä½ <em>ä¸æƒ³äº§ç”Ÿä¸€ä¸ªæ–°å€¼ï¼Œè€Œæƒ³è¦è¾¾åˆ°ä¸€ä¸ªæ•ˆæœï¼Œè¯·ä½¿ç”¨ <code>autorun</code></em>ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæ•ˆæœæ˜¯åƒæ‰“å°æ—¥å¿—ã€å‘èµ·ç½‘ç»œè¯·æ±‚ç­‰è¿™æ ·å‘½ä»¤å¼çš„å‰¯ä½œç”¨ã€‚å¦‚æœä»»ä½•å½±å“è®¡ç®—å€¼çš„å€¼å‘ç”Ÿå˜åŒ–äº†ï¼Œè®¡ç®—å€¼å°†æ ¹æ®çŠ¶æ€è‡ªåŠ¨è¿›è¡Œè¡ç”Ÿã€‚è®¡ç®—å€¼åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥è¢« MobX ä¼˜åŒ–çš„ï¼Œå› ä¸ºå®ƒä»¬è¢«è®¤ä¸ºæ˜¯çº¯å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå‰ä¸€ä¸ªè®¡ç®—ä¸­ä½¿ç”¨çš„æ•°æ®æ²¡æœ‰æ›´æ”¹ï¼Œè®¡ç®—å±æ€§å°†ä¸ä¼šé‡æ–°è¿è¡Œã€‚å¦‚æœæŸä¸ªå…¶å®ƒè®¡ç®—å±æ€§æˆ– reaction æœªä½¿ç”¨è¯¥è®¡ç®—å±æ€§ï¼Œä¹Ÿä¸ä¼šé‡æ–°è¿è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†è¢«æš‚åœã€‚</p></li> <li><p><code>Autorun</code>è‡ªåŠ¨è¿è¡Œã€‚å½“ä½ æƒ³åˆ›å»ºä¸€ä¸ªå“åº”å¼å‡½æ•°ï¼Œè€Œè¯¥å‡½æ•°æœ¬èº«æ°¸è¿œä¸ä¼šæœ‰è§‚å¯Ÿè€…æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>mobx.autorun</code>ã€‚ è¿™é€šå¸¸æ˜¯å½“ä½ éœ€è¦ä»ååº”å¼ä»£ç æ¡¥æ¥åˆ°å‘½ä»¤å¼ä»£ç çš„æƒ…å†µï¼Œä¾‹å¦‚æ‰“å°æ—¥å¿—ã€æŒä¹…åŒ–æˆ–è€…æ›´æ–° UI çš„ä»£ç ã€‚ å½“ä½¿ç”¨ <code>autorun</code> æ—¶ï¼Œæ‰€æä¾›çš„å‡½æ•°æ€»æ˜¯<strong>ç«‹å³è¢«è§¦å‘ä¸€æ¬¡</strong>ï¼Œç„¶å<strong>æ¯æ¬¡å®ƒçš„ä¾èµ–å…³ç³»æ”¹å˜æ—¶ä¼šå†æ¬¡è¢«è§¦å‘</strong>ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<code>computed(function)</code> åˆ›å»ºçš„å‡½æ•°åªæœ‰å½“å®ƒæœ‰è‡ªå·±çš„è§‚å¯Ÿè€…æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ï¼Œå¦åˆ™å®ƒçš„å€¼ä¼šè¢«è®¤ä¸ºæ˜¯ä¸ç›¸å…³çš„ã€‚ ç»éªŒæ³•åˆ™ï¼š<strong>å¦‚æœä½ æœ‰ä¸€ä¸ªå‡½æ•°åº”è¯¥è‡ªåŠ¨è¿è¡Œï¼Œä½†ä¸ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å€¼ï¼Œè¯·ä½¿ç”¨<code>autorun</code>ã€‚ å…¶ä½™æƒ…å†µéƒ½åº”è¯¥ä½¿ç”¨ <code>computed</code></strong>ã€‚ Autoruns æ˜¯å…³äºå¯åŠ¨æ•ˆæœ (initiating effects) çš„ï¼Œè€Œä¸æ˜¯äº§ç”Ÿæ–°çš„å€¼ã€‚ å¦‚æœå­—ç¬¦ä¸²ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ autorunï¼Œå®ƒå°†è¢«ç”¨ä½œè°ƒè¯•åã€‚</p></li> <li><p><code>@observer</code>è£…é¥°å™¨å¯ä»¥ç”¨æ¥å°† React ç»„ä»¶è½¬å˜æˆå“åº”å¼ç»„ä»¶ã€‚ å®ƒç”¨ <code>mobx.autorun</code> åŒ…è£…äº†ç»„ä»¶çš„ <code>render</code> å‡½æ•°ä»¥ç¡®ä¿ä»»ä½•ç»„ä»¶æ¸²æŸ“ä¸­ä½¿ç”¨çš„æ•°æ®å˜åŒ–æ—¶éƒ½å¯ä»¥å¼ºåˆ¶åˆ·æ–°ç»„ä»¶ã€‚ <code>observer</code> æ˜¯ç”±å•ç‹¬çš„ <code>mobx-react</code> åŒ…æä¾›çš„ï¼Œæ‰€ä»¥éœ€è¦è¿™æ ·å¯¼å…¥å®ƒ<code>import {observer} from &quot;mobx-react&quot;</code></p></li> <li><p><code>(@)action</code>åŠ¨ä½œ,ä»»ä½•åº”ç”¨éƒ½æœ‰åŠ¨ä½œã€‚åŠ¨ä½œæ˜¯ä»»ä½•ç”¨æ¥<strong>ä¿®æ”¹çŠ¶æ€</strong>çš„ä¸œè¥¿ã€‚ ä½¿ç”¨ MobX ä½ å¯ä»¥åœ¨ä»£ç ä¸­æ˜¾å¼åœ°æ ‡è®°å‡ºåŠ¨ä½œæ‰€åœ¨çš„ä½ç½®ã€‚ åŠ¨ä½œå¯ä»¥æœ‰åŠ©äºæ›´å¥½çš„ç»„ç»‡ä»£ç ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›å…·æœ‰åŒæ ·ç­¾åçš„å‡½æ•°ï¼Œä½†æ˜¯ç”¨ transactionã€untracked å’Œ allowStateChanges åŒ…è£¹èµ·æ¥ï¼Œå°¤å…¶æ˜¯ transaction çš„è‡ªåŠ¨åº”ç”¨ä¼šäº§ç”Ÿå·¨å¤§çš„æ€§èƒ½æ”¶ç›Šï¼Œ åŠ¨ä½œä¼šåˆ†æ‰¹å¤„ç†å˜åŒ–å¹¶åªåœ¨(æœ€å¤–å±‚çš„)åŠ¨ä½œå®Œæˆåé€šçŸ¥è®¡ç®—å€¼å’Œååº”ã€‚ è¿™å°†ç¡®ä¿åœ¨åŠ¨ä½œå®Œæˆä¹‹å‰ï¼Œåœ¨åŠ¨ä½œæœŸé—´ç”Ÿæˆçš„ä¸­é—´å€¼æˆ–æœªå®Œæˆçš„å€¼å¯¹åº”ç”¨çš„å…¶ä½™éƒ¨åˆ†æ˜¯ä¸å¯è§çš„ã€‚</p></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æ›´æ–°äº:</span> <span class="time">5/4/2020, 9:17:46 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.172e5c27.js" defer></script><script src="/assets/js/2.983eb755.js" defer></script><script src="/assets/js/18.3af7782b.js" defer></script>
  </body>
</html>
